Running: python tuning/run_dpo.py --model 'llama3-8B' --dataset 'tuluif' --train_size '7552' --dynamic_path /home/shougan/projects/aip-fredashi/shougan/balance-budget/tuning/models/llama3-8B_ppl-4.50_sft-640 --sft_train_size '640' --task 'ifeval' --pft_method 'dpo' --do_training
/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/shougan/projects/aip-fredashi/shougan/balance-budget/tuning
ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
INFO 01-21 01:05:21 [__init__.py:244] Automatically detected platform cuda.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
{'model': 'llama3-8B', 'dataset': 'tuluif', 'train_size': 7552, 'dynamic_path': '/home/shougan/projects/aip-fredashi/shougan/balance-budget/tuning/models/llama3-8B_ppl-4.50_sft-640', 'sft_train_size': 640, 'task': 'ifeval', 'pft_method': 'dpo', 'do_training': True, 'do_inference': False, 'do_evaluation': False}
pt-tuluif-7552
llama3-8B_llama3-8B_ppl-4.50_sft-640_pt-tuluif-7552
wandb: Currently logged in as: shougan (shougan-university-of-waterloo) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
Traceback (most recent call last):
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_token.py", line 92, in connect
    sock.connect(self._path)
FileNotFoundError: [Errno 2] No such file or directory

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/project/6105902/shougan/balance-budget/tuning/run_dpo.py", line 78, in <module>
    run = wandb.init(name=run_config.run_name, project="tuning", reinit=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1620, in init
    wandb._sentry.reraise(e)
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/analytics/sentry.py", line 157, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1606, in init
    return wi.init(run_settings, run_config, run_printer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 873, in init
    service = self._wl.ensure_service()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/wandb_setup.py", line 325, in ensure_service
    self._connection = service_connection.connect_to_service(self._settings)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_connection.py", line 31, in connect_to_service
    return ServiceConnection(client=token.connect(), proc=None)
                                    ^^^^^^^^^^^^^^^
  File "/project/6105902/shougan/balance-budget/venv/lib/python3.11/site-packages/wandb/sdk/lib/service/service_token.py", line 94, in connect
    raise WandbServiceConnectionError(
wandb.sdk.lib.service.service_token.WandbServiceConnectionError: Failed to connect to service on socket /tmp/wandb-1411741-1412105-2964194052/socket
